<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Data Migration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #e0e0e0;
        }
        .container {
            background: #2a2a2a;
            padding: 30px;
            border-radius: 12px;
            border: 2px solid #ff8c00;
        }
        h1 {
            color: #ff8c00;
            margin-bottom: 20px;
        }
        button {
            background: #32cd32;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 10px 10px 0;
        }
        button:hover {
            background: #28a428;
        }
        .danger {
            background: #dc143c;
        }
        .danger:hover {
            background: #a00;
        }
        #log {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
        .success {
            color: #32cd32;
        }
        .error {
            color: #dc143c;
        }
        .info {
            color: #ffd700;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî• Firebase Data Migration Tool</h1>
        <p>This will migrate your old Firebase data (numbers only) to the new format (full item objects with names).</p>
        
        <button onclick="migrateAllCamps()">‚úÖ Migrate All Camps</button>
        <button onclick="viewCurrentData()">üëÄ View Current Data</button>
        <button class="danger" onclick="clearAllData()">‚ö†Ô∏è Clear All Data</button>
        
        <div id="log"></div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, get, set } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyB8c84ghiVWE3EW4nkG0_StFKNXam3QhSQ",
            authDomain: "burning-man-budgets.firebaseapp.com",
            databaseURL: "https://burning-man-budgets-default-rtdb.firebaseio.com",
            projectId: "burning-man-budgets",
            storageBucket: "burning-man-budgets.firebasestorage.app",
            messagingSenderId: "558511487220",
            appId: "1:558511487220:web:987417a56493ae6af4c6a1"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<div class="${type}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // Original budget data with proper names
        const originalData = {
            swanForest: {
                revenue: [
                    { name: 'Swan Forest Regular (50 @ $2,350)', amount: 117500, note: '50 regular campers' },
                    { name: 'Swan Forest Class A RV (10 @ $3,250)', amount: 32500, note: '10 Class A RV campers' },
                ],
                operations: [
                    { name: 'Generator Rental', amount: 42000, note: 'May need 2 units for 120 people' },
                    { name: 'Generator Fuel', amount: 11000, note: 'Scaled from $5,920' },
                    { name: 'Equipment Purchases', amount: 13000, note: 'Scaled from $7,234' },
                    { name: 'Cable & Power Distribution', amount: 4200, note: 'Scaled from $2,238' },
                    { name: 'Heavy Equipment Rental', amount: 4600, note: 'Scaled from $2,491' },
                    { name: 'Water Fills', amount: 10000, note: 'Increased for 120 people' },
                    { name: 'Pump Outs', amount: 17500, note: 'Scaled from $9,415' },
                    { name: 'Fuel (vehicles/misc)', amount: 11000, note: 'Scaled from $5,921' },
                    { name: 'Deluxe Bathroom ($912.17 + $27.27 Containment Tray)', amount: 939.44, note: 'Premium bathroom rental with tray' },
                ],
                vehicles: [
                    { name: 'Refrigerated Truck (Penske 24-26ft, 3 weeks)', amount: 2500, note: 'Includes truck rental + fuel' },
                    { name: 'Swan Repairs & Maint', amount: 4500, note: 'Similar to 2025' },
                    { name: 'Trailer Repairs', amount: 2000, note: 'Similar to 2025' },
                    { name: 'Bike Equipment & Repairs', amount: 1500, note: 'Reduced from $5,000' },
                    { name: 'Small Generator Maint', amount: 600, note: 'Same as 2025' },
                    { name: 'Box Truck Rental (2 Penske 22-26ft, 3 weeks)', amount: 5500, note: '2 trucks @ ~$2,750 each' },
                ],
                swag: [
                    { name: 'Camp Patches', amount: 500, note: 'Similar to 2025' },
                    { name: 'Swag Bags', amount: 1300, note: 'Scaled from $700' },
                    { name: 'Pins & Stickers', amount: 1000, note: 'Scaled from $550' },
                    { name: 'Yeti Cups (120 @ $5.42)', amount: 650, note: 'Bulk rate' },
                    { name: 'Custom Enamel Pins', amount: 2000, note: 'New for 2026' },
                    { name: 'Camp Hoodies', amount: 1500, note: 'New swag item' },
                ],
                food: [
                    { name: 'Perishable Food', amount: 7500, note: 'Increased for 120 people' },
                    { name: 'Costco Bulk Items', amount: 6000, note: 'Scaled from $3,237' },
                    { name: 'Alcohol & Beverages', amount: 3200, note: 'Scaled from $1,719' },
                    { name: 'Chef & Kitchen Staff', amount: 2000, note: 'New expense' },
                ],
                lodging: [
                    { name: 'Forest House Lodging', amount: 7500, note: 'Increased for 2026' },
                    { name: 'Forest House Staff', amount: 3000, note: 'Similar to 2025' },
                    { name: 'Forest House Equipment', amount: 750, note: 'Similar to 2025' },
                    { name: 'Event Tickets (@$750.00)', amount: 5500, note: 'Scaled from $3,000' },
                ],
                decor: [
                    { name: 'Camp Decor & Lighting', amount: 3000, note: 'Ambient lighting, decorations' },
                    { name: 'Shade Structures & Fabric', amount: 1500, note: 'Additional shade materials' },
                ],
                cleaning: [
                    { name: 'Cleaning Supplies', amount: 800, note: 'Sanitizers, soap, trash bags' },
                    { name: 'Porta-Potty Servicing', amount: 1200, note: 'Additional servicing if needed' },
                ],
                miscellaneous: [
                    { name: 'Contingency Fund', amount: 5000, note: 'Emergency & unexpected costs' },
                    { name: 'Insurance & Permits', amount: 2000, note: 'Event insurance, permits' },
                    { name: 'Communications (Radios)', amount: 1000, note: 'Radio rentals & batteries' },
                ],
                staff: [
                    { name: 'Event Staff Wages', amount: 4000, note: 'Setup/breakdown crew' },
                ]
            },
            xanadu: {
                revenue: [
                    { name: 'Xanadu Campers (30 @ $2,250)', amount: 67500, note: '30 campers' },
                ],
                operations: [
                    { name: 'Generator Rental', amount: 42000, note: 'May need 2 units for 120 people' },
                    { name: 'Generator Fuel', amount: 11000, note: 'Scaled from $5,920' },
                    { name: 'Equipment Purchases', amount: 13000, note: 'Scaled from $7,234' },
                    { name: 'Cable & Power Distribution', amount: 4200, note: 'Scaled from $2,238' },
                    { name: 'Heavy Equipment Rental', amount: 4600, note: 'Scaled from $2,491' },
                    { name: 'Water Fills', amount: 10000, note: 'Increased for 120 people' },
                    { name: 'Pump Outs', amount: 17500, note: 'Scaled from $9,415' },
                    { name: 'Fuel (vehicles/misc)', amount: 11000, note: 'Scaled from $5,921' },
                    { name: 'Deluxe Bathroom ($912.17 + $27.27 Containment Tray)', amount: 939.44, note: 'Premium bathroom rental with tray' },
                ],
                vehicles: [
                    { name: 'Refrigerated Truck (Penske 24-26ft, 3 weeks)', amount: 2500, note: 'Includes truck rental + fuel' },
                    { name: 'Swan Repairs & Maint', amount: 4500, note: 'Similar to 2025' },
                    { name: 'Trailer Repairs', amount: 2000, note: 'Similar to 2025' },
                    { name: 'Bike Equipment & Repairs', amount: 1500, note: 'Reduced from $5,000' },
                    { name: 'Small Generator Maint', amount: 600, note: 'Same as 2025' },
                    { name: 'Box Truck Rental (2 Penske 22-26ft, 3 weeks)', amount: 5500, note: '2 trucks @ ~$2,750 each' },
                ],
                swag: [
                    { name: 'Camp Patches', amount: 500, note: 'Similar to 2025' },
                    { name: 'Swag Bags', amount: 1300, note: 'Scaled from $700' },
                    { name: 'Pins & Stickers', amount: 1000, note: 'Scaled from $550' },
                    { name: 'Yeti Cups (120 @ $5.42)', amount: 650, note: 'Bulk rate' },
                    { name: 'Custom Enamel Pins', amount: 2000, note: 'New for 2026' },
                    { name: 'Camp Hoodies', amount: 1500, note: 'New swag item' },
                ],
                food: [
                    { name: 'Perishable Food', amount: 7500, note: 'Increased for 120 people' },
                    { name: 'Costco Bulk Items', amount: 6000, note: 'Scaled from $3,237' },
                    { name: 'Alcohol & Beverages', amount: 3200, note: 'Scaled from $1,719' },
                    { name: 'Chef & Kitchen Staff', amount: 2000, note: 'New expense' },
                ],
                lodging: [
                    { name: 'Forest House Lodging', amount: 7500, note: 'Increased for 2026' },
                    { name: 'Forest House Staff', amount: 3000, note: 'Similar to 2025' },
                    { name: 'Forest House Equipment', amount: 750, note: 'Similar to 2025' },
                    { name: 'Event Tickets (@$750.00)', amount: 5500, note: 'Scaled from $3,000' },
                ],
                decor: [
                    { name: 'Camp Decor & Lighting', amount: 3000, note: 'Ambient lighting, decorations' },
                    { name: 'Shade Structures & Fabric', amount: 1500, note: 'Additional shade materials' },
                ],
                cleaning: [
                    { name: 'Cleaning Supplies', amount: 800, note: 'Sanitizers, soap, trash bags' },
                    { name: 'Porta-Potty Servicing', amount: 1200, note: 'Additional servicing if needed' },
                ],
                miscellaneous: [
                    { name: 'Contingency Fund', amount: 5000, note: 'Emergency & unexpected costs' },
                    { name: 'Insurance & Permits', amount: 2000, note: 'Event insurance, permits' },
                    { name: 'Communications (Radios)', amount: 1000, note: 'Radio rentals & batteries' },
                ],
                staff: [
                    { name: 'Event Staff Wages', amount: 4000, note: 'Setup/breakdown crew' },
                ],
                xanaduOnly: [
                    { name: 'Camp Director Fee', amount: 5000, note: 'Xanadu-only expense' },
                ]
            },
            liveEdge: {
                revenue: [
                    { name: 'Live Edge Campers (30 @ $2,250)', amount: 67500, note: '30 campers' },
                ],
                operations: [
                    { name: 'Generator Rental', amount: 42000, note: 'May need 2 units for 120 people' },
                    { name: 'Generator Fuel', amount: 11000, note: 'Scaled from $5,920' },
                    { name: 'Equipment Purchases', amount: 13000, note: 'Scaled from $7,234' },
                    { name: 'Cable & Power Distribution', amount: 4200, note: 'Scaled from $2,238' },
                    { name: 'Heavy Equipment Rental', amount: 4600, note: 'Scaled from $2,491' },
                    { name: 'Water Fills', amount: 10000, note: 'Increased for 120 people' },
                    { name: 'Pump Outs', amount: 17500, note: 'Scaled from $9,415' },
                    { name: 'Fuel (vehicles/misc)', amount: 11000, note: 'Scaled from $5,921' },
                    { name: 'Deluxe Bathroom ($912.17 + $27.27 Containment Tray)', amount: 939.44, note: 'Premium bathroom rental with tray' },
                ],
                vehicles: [
                    { name: 'Refrigerated Truck (Penske 24-26ft, 3 weeks)', amount: 2500, note: 'Includes truck rental + fuel' },
                    { name: 'Swan Repairs & Maint', amount: 4500, note: 'Similar to 2025' },
                    { name: 'Trailer Repairs', amount: 2000, note: 'Similar to 2025' },
                    { name: 'Bike Equipment & Repairs', amount: 1500, note: 'Reduced from $5,000' },
                    { name: 'Small Generator Maint', amount: 600, note: 'Same as 2025' },
                    { name: 'Box Truck Rental (2 Penske 22-26ft, 3 weeks)', amount: 5500, note: '2 trucks @ ~$2,750 each' },
                ],
                swag: [
                    { name: 'Camp Patches', amount: 500, note: 'Similar to 2025' },
                    { name: 'Swag Bags', amount: 1300, note: 'Scaled from $700' },
                    { name: 'Pins & Stickers', amount: 1000, note: 'Scaled from $550' },
                    { name: 'Yeti Cups (120 @ $5.42)', amount: 650, note: 'Bulk rate' },
                    { name: 'Custom Enamel Pins', amount: 2000, note: 'New for 2026' },
                    { name: 'Camp Hoodies', amount: 1500, note: 'New swag item' },
                ],
                food: [
                    { name: 'Perishable Food', amount: 7500, note: 'Increased for 120 people' },
                    { name: 'Costco Bulk Items', amount: 6000, note: 'Scaled from $3,237' },
                    { name: 'Alcohol & Beverages', amount: 3200, note: 'Scaled from $1,719' },
                    { name: 'Chef & Kitchen Staff', amount: 2000, note: 'New expense' },
                ],
                lodging: [
                    { name: 'Forest House Lodging', amount: 7500, note: 'Increased for 2026' },
                    { name: 'Forest House Staff', amount: 3000, note: 'Similar to 2025' },
                    { name: 'Forest House Equipment', amount: 750, note: 'Similar to 2025' },
                    { name: 'Event Tickets (@$750.00)', amount: 5500, note: 'Scaled from $3,000' },
                ],
                decor: [
                    { name: 'Camp Decor & Lighting', amount: 3000, note: 'Ambient lighting, decorations' },
                    { name: 'Shade Structures & Fabric', amount: 1500, note: 'Additional shade materials' },
                ],
                cleaning: [
                    { name: 'Cleaning Supplies', amount: 800, note: 'Sanitizers, soap, trash bags' },
                    { name: 'Porta-Potty Servicing', amount: 1200, note: 'Additional servicing if needed' },
                ],
                miscellaneous: [
                    { name: 'Contingency Fund', amount: 5000, note: 'Emergency & unexpected costs' },
                    { name: 'Insurance & Permits', amount: 2000, note: 'Event insurance, permits' },
                    { name: 'Communications (Radios)', amount: 1000, note: 'Radio rentals & batteries' },
                ],
                staff: [
                    { name: 'Event Staff Wages', amount: 4000, note: 'Setup/breakdown crew' },
                ]
            }
        };

        window.migrateAllCamps = async function() {
            log('Starting migration...', 'info');
            
            try {
                // Migrate Swan Forest
                log('Migrating Swan Forest...', 'info');
                await set(ref(database, 'budgets/swan-forest'), originalData.swanForest);
                log('‚úÖ Swan Forest migrated successfully', 'success');
                
                // Migrate Xanadu
                log('Migrating Xanadu...', 'info');
                await set(ref(database, 'budgets/xanadu'), originalData.xanadu);
                log('‚úÖ Xanadu migrated successfully', 'success');
                
                // Migrate Live Edge
                log('Migrating Live Edge...', 'info');
                await set(ref(database, 'budgets/live-edge'), originalData.liveEdge);
                log('‚úÖ Live Edge migrated successfully', 'success');
                
                log('üéâ All camps migrated! Refresh your budget pages.', 'success');
            } catch (error) {
                log('‚ùå Error: ' + error.message, 'error');
            }
        };

        window.viewCurrentData = async function() {
            log('Fetching current data...', 'info');
            
            try {
                const swanSnapshot = await get(ref(database, 'budgets/swan-forest'));
                const xanaduSnapshot = await get(ref(database, 'budgets/xanadu'));
                const liveEdgeSnapshot = await get(ref(database, 'budgets/live-edge'));
                
                log('=== SWAN FOREST ===', 'info');
                log(JSON.stringify(swanSnapshot.val(), null, 2), 'info');
                
                log('=== XANADU ===', 'info');
                log(JSON.stringify(xanaduSnapshot.val(), null, 2), 'info');
                
                log('=== LIVE EDGE ===', 'info');
                log(JSON.stringify(liveEdgeSnapshot.val(), null, 2), 'info');
            } catch (error) {
                log('‚ùå Error: ' + error.message, 'error');
            }
        };

        window.clearAllData = async function() {
            if (!confirm('‚ö†Ô∏è This will DELETE ALL budget data! Are you sure?')) {
                return;
            }
            
            if (!confirm('Really sure? This cannot be undone!')) {
                return;
            }
            
            log('Clearing all data...', 'info');
            
            try {
                await set(ref(database, 'budgets/swan-forest'), null);
                await set(ref(database, 'budgets/xanadu'), null);
                await set(ref(database, 'budgets/live-edge'), null);
                log('‚úÖ All data cleared', 'success');
            } catch (error) {
                log('‚ùå Error: ' + error.message, 'error');
            }
        };
    </script>
</body>
</html>
